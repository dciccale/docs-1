"use strict";(self.webpackChunkplatformatic_oss_website=self.webpackChunkplatformatic_oss_website||[]).push([[9264,6667],{26:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var i=n(4848),s=n(8453),r=n(5221);const o={},a="Plugin",l={id:"composer/plugin",title:"Plugin",description:"To extend the functionality of a service in Platformatic, you can register a plugin. These plugins are standard Fastify plugins.",source:"@site/docs/composer/plugin.md",sourceDirName:"composer",slug:"/composer/plugin",permalink:"/docs/next/composer/plugin",draft:!1,unlisted:!1,editUrl:"https://github.com/platformatic/platformatic/edit/main/docs/composer/plugin.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"API modification",permalink:"/docs/next/composer/api-modification"},next:{title:"Overview",permalink:"/docs/next/db/overview"}},c={},d=[{value:"Plugin Configuration",id:"plugin-configuration",level:2},{value:"Creating a Plugin",id:"creating-a-plugin",level:3},{value:"Example Plugin",id:"example-plugin",level:4},{value:"Hot Reload",id:"hot-reload",level:2},{value:"Directory Structure",id:"directory-structure",level:2},{value:"Example Directory Structure",id:"example-directory-structure",level:3},{value:"Loading Multiple Plugins",id:"loading-multiple-plugins",level:2},...r.toc];function u(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"plugin",children:"Plugin"}),"\n",(0,i.jsxs)(t.p,{children:["To extend the functionality of a service in Platformatic, you can register a ",(0,i.jsx)(t.a,{href:"https://fastify.dev/docs/latest/Reference/Plugins/",children:"plugin"}),". These plugins are standard ",(0,i.jsx)(t.a,{href:"https://fastify.io",children:"Fastify"})," plugins."]}),"\n",(0,i.jsx)(t.h2,{id:"plugin-configuration",children:"Plugin Configuration"}),"\n",(0,i.jsx)(t.p,{children:"Specify the location of your plugin files in the configuration file, as shown in the example below. This path is relative to the config file path."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-json",children:'{\n  ...\n  "plugins": {\n    "paths": ["./plugin/index.js"]\n  }\n}\n'})}),"\n",(0,i.jsx)(t.h3,{id:"creating-a-plugin",children:"Creating a Plugin"}),"\n",(0,i.jsx)(t.p,{children:"Your plugin should export an asynchronous function that receives the parameters:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"app"})," (",(0,i.jsx)(t.code,{children:"FastifyInstance"}),"): this is the main fastify ",(0,i.jsx)(t.a,{href:"https://www.fastify.io/docs/latest/Reference/Server/#instance",children:"instance"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"opts"}),": contains all the options specified in the config file after ",(0,i.jsx)(t.code,{children:"path"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.h4,{id:"example-plugin",children:"Example Plugin"}),"\n",(0,i.jsx)(t.p,{children:"Here's a simple example of a Fastify plugin:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-js",children:"module.exports = async function (app, opts) {\n  app.get('/hello', async (request, reply) => {\n    return 'Hello from Platformatic!';\n  });\n}\n"})}),"\n",(0,i.jsx)(t.h2,{id:"hot-reload",children:"Hot Reload"}),"\n",(0,i.jsxs)(t.p,{children:["The plugin file is monitored by the ",(0,i.jsx)(t.a,{href:"https://nodejs.org/api/fs.html#fspromiseswatchfilename-options",children:(0,i.jsx)(t.code,{children:"fs.watch"})})," function. There's no need to manually reload the Platformatic Composer server while developing your plugin. Changes are detected automatically, triggering a server restart to load your updated code."]}),"\n",(0,i.jsx)(t.admonition,{type:"tip",children:(0,i.jsxs)(t.p,{children:["Currently, on Linux, file watching in subdirectories is not supported due to a Node.js limitation, as documented ",(0,i.jsx)(t.a,{href:"https://nodejs.org/api/fs.html#caveats",children:"here"}),"."]})}),"\n",(0,i.jsx)(t.h2,{id:"directory-structure",children:"Directory Structure"}),"\n",(0,i.jsxs)(t.p,{children:["Plugins can also be directories, which are loaded using ",(0,i.jsx)(t.a,{href:"https://github.com/fastify/fastify-autoload",children:(0,i.jsx)(t.code,{children:"@fastify/autoload"})}),". This approach automatically configures routes matching the folder structure."]}),"\n",(0,i.jsx)(t.h3,{id:"example-directory-structure",children:"Example Directory Structure"}),"\n",(0,i.jsx)(t.p,{children:"Consider the following directory structure for organizing multiple plugins:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"\u251c\u2500\u2500 routes\n\u2502   \u251c\u2500\u2500 foo\n\u2502   \u2502   \u251c\u2500\u2500 something.js\n\u2502   \u2502   \u2514\u2500\u2500 bar\n\u2502   \u2502       \u2514\u2500\u2500 baz.js\n\u2502   \u251c\u2500\u2500 single-plugin\n\u2502   \u2502   \u2514\u2500\u2500 utils.js\n\u2502   \u2514\u2500\u2500 another-plugin.js\n\u2514\u2500\u2500 platformatic.json\n"})}),"\n",(0,i.jsxs)(t.p,{children:["By default, each folder will be added as a prefix to the routes defined within them. Refer to the ",(0,i.jsx)(t.a,{href:"https://github.com/fastify/fastify-autoload",children:"@fastify/autoload"})," documentation for customization options."]}),"\n",(0,i.jsx)(t.h2,{id:"loading-multiple-plugins",children:"Loading Multiple Plugins"}),"\n",(0,i.jsx)(t.p,{children:"To load multiple plugins in parallel, specify an array of paths in the configuration:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-json",children:'{\n  ...\n  "plugins": {\n    "paths": [{\n      "path": "./plugin/index.js"\n    }, {\n      "path": "./routes/"\n    }]\n  }\n}\n'})}),"\n",(0,i.jsx)(r.default,{})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},5221:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var i=n(4848),s=n(8453);const r={},o=void 0,a={id:"getting-started/issues",title:"issues",description:"Issues",source:"@site/docs/getting-started/issues.md",sourceDirName:"getting-started",slug:"/getting-started/issues",permalink:"/docs/next/getting-started/issues",draft:!1,unlisted:!1,editUrl:"https://github.com/platformatic/platformatic/edit/main/docs/getting-started/issues.md",tags:[],version:"current",frontMatter:{}},l={},c=[{value:"Issues",id:"issues",level:2}];function d(e){const t={a:"a",h2:"h2",p:"p",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"issues",children:"Issues"}),"\n",(0,i.jsxs)(t.p,{children:["If you run into a bug or have a suggestion for improvement, please raise an\n",(0,i.jsx)(t.a,{href:"https://github.com/platformatic/platformatic/issues/new",children:"issue on GitHub"})," or join our ",(0,i.jsx)(t.a,{href:"https://discord.gg/platformatic",children:"Discord feedback"})," channel."]})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(6540);const s={},r=i.createContext(s);function o(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);